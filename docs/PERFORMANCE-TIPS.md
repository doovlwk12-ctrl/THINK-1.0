# تحسين التحميل والتنقّل بين الصفحات

نصائح مختصرة لتقليل البطء في التحميل والتنقّل.

---

## ما تم تطبيقه في المشروع

- **شريط تقدم التنقّل (NextTopLoader):** يظهر شريطاً رفيعاً أعلى الصفحة عند التنقّل بين الروابط لتحسين الإحساس بالسرعة.
- **صفحات تحميل (loading.tsx):** عدة مسارات تحتوي على `loading.tsx` لعرض "جاري التحميل..." أثناء جلب البيانات بدلاً من شاشة فارغة.
- **كاش على السيرفر:** واجهات مثل `/api/content/homepage` و `/api/packages` تستخدم كاش (revalidate 60 ثانية) لتقليل الضغط على قاعدة البيانات.

---

## تحقّقات احتياطية (إن استمرّ البطء)

| # | التحقق |
|---|--------|
| 1 | **DATABASE_URL على Vercel:** تأكد أنه ينتهي بـ `?pgbouncer=true` ويفضّل `&connection_limit=1` لتفادي استنفاد الاتصالات (راجع `docs/VERCEL-DATABASE-FIX.md`). |
| 2 | **منطقة Vercel:** اختر منطقة نشر (Region) قريبة من منطقة قاعدة بيانات Supabase لتقليل زمن الرحلة. |
| 3 | **مشروع Supabase:** المشاريع المجانية قد "تنام" بعد عدم استخدام؛ الاستجابة الأولى بعد ذلك تكون أبطأ. |

---

## للمطورين (تحسينات إضافية لاحقاً)

- تقليل حجم الصور (ضغط أو أحجام متجاوبة) إن وُجدت في المحتوى.
- استخدام **SWR** أو كاش من جهة العميل للبيانات التي لا تتغيّر كثيراً (مثل قائمة الباقات) مع `revalidateOnFocus: false` إن لزم.
- مراجعة الصفحات الثقيلة: هل يمكن جلب جزء من البيانات أولاً ثم الباقي (streaming أو تحميل كسول).
