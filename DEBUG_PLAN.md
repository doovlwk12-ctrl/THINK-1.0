# ุฎุทุฉ ุญู ูุดููุฉ "Failed to fetch"

## ๐ ุชุญููู ุงููุดููุฉ

### ุงูุฃุนุฑุงุถ:
- ุฎุทุฃ "Failed to fetch" ูุธูุฑ ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู ูุจุงุดุฑุฉ
- ุงูุชุทุจูู ุนุงูู ูู ุญุงูุฉ ุงูุชุญููู
- ุงูู middleware ูุนูู ุจุดูู ุตุญูุญ (ููุฌุฏ ุณุฌูุงุช)
- ูุง ุชูุฌุฏ ุณุฌูุงุช ูู `lib/api.ts` ุฃู `useApi.ts`

### ุงููุฑุถูุงุช ุงููุญุชููุฉ:
1. **CSP (Content Security Policy)** ูููุน ุงูุงุชุตุงูุงุช
2. **ูุดููุฉ ูู URL** - ุงุณุชุฎุฏุงู `/api` ุจุฏูุงู ูู URL ูุงูู
3. **ูุดููุฉ ูู ุงูุฎุงุฏู** - ุงูุฎุงุฏู ูุง ูุณุชุฌูุจ
4. **ูุดููุฉ ูู CORS** - ุฑุบู ุฃููุง ูุณุชุฎุฏู ููุณ ุงูุฃุตู
5. **ูุดููุฉ ูู instrumentation** - `fetch` ูู instrumentation ููุดู ููููุน ุงูููุฏ

---

## ๐ฏ ุงูุฎุทุฉ ุงูุชูููุฐูุฉ

### ุงููุฑุญูุฉ 1: ุงูุชุญูู ูู CSP (ุงูุฃููููุฉ ุงูุนุงููุฉ)

**ุงููุดููุฉ ุงููุญุชููุฉ:**
- CSP ูู `next.config.js` ูุญุชูู ุนูู `connect-src 'self'` ุงูุฐู ูุฏ ูููุน ุจุนุถ ุงูุงุชุตุงูุงุช
- ูุฏ ูููุน CSP ุงูุงุชุตุงูุงุช ุฅูู `127.0.0.1:7244` (instrumentation)

**ุงูุญู:**
1. ุชุนุฏูู CSP ูู `next.config.js`:
   - ุฅุถุงูุฉ `http://127.0.0.1:7244` ุฅูู `connect-src` (ููุชุทููุฑ ููุท)
   - ุฃู ุชุนุทูู CSP ูุคูุชุงู ููุชุทููุฑ

**ุงููููุงุช:**
- `next.config.js`

---

### ุงููุฑุญูุฉ 2: ุฅุตูุงุญ `lib/api.ts` (ุงูุฃููููุฉ ุงูุนุงููุฉ)

**ุงููุดููุฉ ุงููุญุชููุฉ:**
- `fetch` ููุดู ูุจู ุงููุตูู ุฅูู ุงูุฎุงุฏู
- ูุฏ ุชููู ุงููุดููุฉ ูู ููููุฉ ุงุณุชุฏุนุงุก `fetch`

**ุงูุญู:**
1. ุฅุถุงูุฉ ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก
2. ุฅุถุงูุฉ retry logic
3. ุงูุชุฃูุฏ ูู ุฃู `fetch` ูุณุชุฎุฏู credentials ุจุดูู ุตุญูุญ
4. ุฅุถุงูุฉ timeout ููุทูุจุงุช

**ุงููููุงุช:**
- `lib/api.ts`

---

### ุงููุฑุญูุฉ 3: ุฅุตูุงุญ instrumentation (ุงูุฃููููุฉ ุงููุชูุณุทุฉ)

**ุงููุดููุฉ ุงููุญุชููุฉ:**
- `fetch` ูู instrumentation ููุดู ุจุตูุช
- ูุฏ ูููุน ูุฐุง ุชูููุฐ ุงูููุฏ ุงูุชุงูู

**ุงูุญู:**
1. ุฌุนู instrumentation ุบูุฑ ูุชุฒุงูู (async) ุจุดูู ุตุญูุญ
2. ุงุณุชุฎุฏุงู `console.log` ูุจุฏูู ููุชุฃูุฏ ูู ูุตูู ุงูููุฏ
3. ุฅุฒุงูุฉ instrumentation ูุคูุชุงู ููุชุญูู ูู ุฃู ุงููุดููุฉ ููุณุช ููู

**ุงููููุงุช:**
- `lib/api.ts`
- `hooks/useApi.ts`
- `middleware.ts`

---

### ุงููุฑุญูุฉ 4: ุงูุชุญูู ูู ุงูุฎุงุฏู (ุงูุฃููููุฉ ุงูุนุงููุฉ)

**ุงููุดููุฉ ุงููุญุชููุฉ:**
- ุงูุฎุงุฏู ูุง ูุณุชุฌูุจ
- ุงูุฎุงุฏู ูุชููู
- ูุดููุฉ ูู Next.js dev server

**ุงูุญู:**
1. ุงูุชุญูู ูู ุฃู `npm run dev` ูุนูู
2. ุงูุชุญูู ูู ุฃู ุงูุฎุงุฏู ูุณุชูุน ุนูู ุงููููุฐ ุงูุตุญูุญ
3. ุงุฎุชุจุงุฑ API route ูุจุงุดุฑุฉ (ูุซู `/api/orders/my-orders`)

**ุงูุฃูุงูุฑ:**
```bash
# ุงูุชุญูู ูู ุญุงูุฉ ุงูุฎุงุฏู
curl http://localhost:3000/api/orders/my-orders

# ุฃู ูู ุงููุชุตูุญ
http://localhost:3000/api/orders/my-orders
```

---

### ุงููุฑุญูุฉ 5: ุฅุตูุงุญ `useApi` hook (ุงูุฃููููุฉ ุงููุชูุณุทุฉ)

**ุงููุดููุฉ ุงููุญุชููุฉ:**
- `useApi` ูุง ูุนุงูุฌ ุงูุฃุฎุทุงุก ุจุดูู ุตุญูุญ
- ูุฏ ูููู ููุงู ูุดููุฉ ูู ููููุฉ ุงุณุชุฏุนุงุก `apiClient.get`

**ุงูุญู:**
1. ุฅุถุงูุฉ ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก
2. ุฅุถุงูุฉ retry logic
3. ุงูุชุฃูุฏ ูู ุฃู `execute` ูุชู ุงุณุชุฏุนุงุคู ุจุดูู ุตุญูุญ

**ุงููููุงุช:**
- `hooks/useApi.ts`
- `app/(client)/dashboard/page.tsx`

---

### ุงููุฑุญูุฉ 6: ุฅุถุงูุฉ Error Boundary (ุงูุฃููููุฉ ุงูููุฎูุถุฉ)

**ุงููุดููุฉ ุงููุญุชููุฉ:**
- ุงูุฃุฎุทุงุก ูุง ูุชู ูุนุงูุฌุชูุง ุจุดูู ุตุญูุญ
- ุงูุชุทุจูู ูุนูู ูู ุญุงูุฉ ุงูุชุญููู

**ุงูุญู:**
1. ุงูุชุฃูุฏ ูู ุฃู Error Boundary ูุนูู ุจุดูู ุตุญูุญ
2. ุฅุถุงูุฉ fallback UI ููุฃุฎุทุงุก

**ุงููููุงุช:**
- `components/ErrorBoundary.tsx`
- `components/providers/ErrorBoundaryProvider.tsx`

---

## ๐ง ุฎุทูุงุช ุงูุชูููุฐ ุงูุชูุตูููุฉ

### ุงูุฎุทูุฉ 1: ุชุนุฏูู CSP (5 ุฏูุงุฆู)

```javascript
// next.config.js
'connect-src': [
  "'self'",
  'http://127.0.0.1:7244', // ููุชุทููุฑ ููุท
  'http://localhost:3000',
]
```

### ุงูุฎุทูุฉ 2: ุฅุตูุงุญ `lib/api.ts` (10 ุฏูุงุฆู)

1. ุฅุถุงูุฉ credentials ุฅูู `fetch`
2. ุฅุถุงูุฉ timeout
3. ุฅุถุงูุฉ retry logic
4. ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### ุงูุฎุทูุฉ 3: ุฅุฒุงูุฉ instrumentation ูุคูุชุงู (5 ุฏูุงุฆู)

1. ุฅุฒุงูุฉ ุฌููุน `fetch` calls ูู instrumentation
2. ุงูุงุญุชูุงุธ ุจู `console.log` ููุท
3. ุงุฎุชุจุงุฑ ุฅุฐุง ูุงูุช ุงููุดููุฉ ุชุฎุชูู

### ุงูุฎุทูุฉ 4: ุงุฎุชุจุงุฑ ุงูุฎุงุฏู (5 ุฏูุงุฆู)

1. ูุชุญ `/api/orders/my-orders` ูุจุงุดุฑุฉ ูู ุงููุชุตูุญ
2. ุงูุชุญูู ูู ุฃู ุงูุฎุงุฏู ูุณุชุฌูุจ
3. ุงูุชุญูู ูู ุฃู ุงูู middleware ูุนูู

### ุงูุฎุทูุฉ 5: ุฅุตูุงุญ `useApi` (10 ุฏูุงุฆู)

1. ุฅุถุงูุฉ ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก
2. ุฅุถุงูุฉ retry logic
3. ุงูุชุฃูุฏ ูู ุฃู `loading` ูุชู ุชุญุฏูุซู ุจุดูู ุตุญูุญ

---

## โ ูุนุงููุฑ ุงููุฌุงุญ

1. โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก "Failed to fetch"
2. โ ุงูุจูุงูุงุช ุชูุญููู ุจุดูู ุตุญูุญ ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู
3. โ ุงูุชุทุจูู ูุง ูุนูู ูู ุญุงูุฉ ุงูุชุญููู
4. โ ุฌููุน API calls ุชุนูู ุจุดูู ุตุญูุญ

---

## ๐งช ุงุฎุชุจุงุฑุงุช ุงูุชุญูู

### ุงุฎุชุจุงุฑ 1: ุชุณุฌูู ุงูุฏุฎูู
- [ ] ุชุณุฌูู ุงูุฏุฎูู ุจุญุณุงุจ ุงูุนููู
- [ ] ุงูุชุญูู ูู ุฃู ููุญุฉ ุงูุชุญูู ุชูุญููู ุจุฏูู ุฃุฎุทุงุก
- [ ] ุงูุชุญูู ูู ุฃู ุงูุทูุจุงุช ุชุธูุฑ

### ุงุฎุชุจุงุฑ 2: API Calls
- [ ] ุงุฎุชุจุงุฑ `/api/orders/my-orders` ูุจุงุดุฑุฉ
- [ ] ุงุฎุชุจุงุฑ `/api/notifications` ูุจุงุดุฑุฉ
- [ ] ุงูุชุญูู ูู ุฃู ุฌููุน API calls ุชุนูู

### ุงุฎุชุจุงุฑ 3: Error Handling
- [ ] ุงุฎุชุจุงุฑ ูุง ูุญุฏุซ ุนูุฏ ูุดู API call
- [ ] ุงูุชุญูู ูู ุฃู Error Boundary ูุนูู
- [ ] ุงูุชุญูู ูู ุฃู ุฑุณุงุฆู ุงูุฎุทุฃ ูุงุถุญุฉ

---

## ๐ ููุงุญุธุงุช ุฅุถุงููุฉ

1. **CSP ูู ุงูุชุทููุฑ:** ูููู ุชุนุทูู CSP ูุคูุชุงู ูู ุงูุชุทููุฑ ููุชุญูู ูู ุฃู ุงููุดููุฉ ููุณุช ููู
2. **Instrumentation:** ุฅุฐุง ูุงูุช ุงููุดููุฉ ูู instrumentationุ ูููู ุฅุฒุงูุชู ูุคูุชุงู
3. **ุงูุฎุงุฏู:** ุชุฃูุฏ ูู ุฃู `npm run dev` ูุนูู ุจุดูู ุตุญูุญ
4. **ุงููุชุตูุญ:** ุฌุฑุจ ูู ูุชุตูุญุงุช ูุฎุชููุฉ (Chrome, Firefox, Edge)

---

## ๐จ ุฅุฐุง ูุดูุช ุฌููุน ุงูุญููู

ุฅุฐุง ูุดูุช ุฌููุน ุงูุญููู ุฃุนูุงูุ ูุฏ ุชููู ุงููุดููุฉ ูู:
1. **Next.js configuration** - ูุฏ ุชุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุชููุฆุฉ Next.js
2. **Network issues** - ูุฏ ุชููู ููุงู ูุดููุฉ ูู ุงูุดุจูุฉ
3. **Browser issues** - ูุฏ ุชููู ููุงู ูุดููุฉ ูู ุงููุชุตูุญ

ูู ูุฐู ุงูุญุงูุฉ:
1. ุญุงูู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู
2. ุญุงูู ูุณุญ cache ุงููุชุตูุญ
3. ุญุงูู ุฅุนุงุฏุฉ ุชุซุจูุช dependencies
